<script>
  import { current_component } from "svelte/internal";
  import { getEventsAction } from "../utils/get-events-action.js";

  /**
   * Specify the tabindex
   * @type {string}[tabindex="0"]
   */
  export let tabindex = 0;

  /**
   * Set to `true` to disable the button
   * @type {boolean}[disabled=false]
   */
  export let disabled = false;

  /**
   * Specify the id
   * @type {string}[id=""]
   */
  export let id = "";

  /**
   * Specify the aria-label
   * @type {string} [aria-label="button"]
   */
  export let ariaLabel = "button";

  /**
   * Set the `href` to use an anchor link
   * @type {string}[href = ""]
   */
  export let href = "";
  /**
   * Preconditions: href
   * Where to display the linked URL
   * @type {"_self" | "_blank" | "_parent" | "_top"}[target = ""]
   */
  export let target = "";

  /**
   * Specify the `type` attribute for the button element
   * @type {"button"|"submit"|"reset"}[type="button"]
   */
  export let type = "button";

  /**
   * Specify the exterior of button
   * @type {"general" | "clear" | "logic-or" | "logic-and"  |"action"} [exterior="general"]
   */
  export let exterior = "general";

  /**
   * Specify the variant of button
   * @type {"cta" | "overBackground" | "primary" | "secondary" | "warning"} [variant="cta"]
   */
  export let variant = "cta";

  /**
   * Specify the quiet mode of button
   * @type { boolean } [isQuiet= false]
   */
  export let isQuiet = false;

  /**
   * Specify the selected status of button
   * @type { boolean } [isSelected= false]
   */
  export let isSelected = false;

  /**
   * Preconditions: exterior === "clear"
   * Specify the small mode of button
   * @type { boolean } [isSmall= false]
   */
  export let isSmall = false;

  /**
   * Preconditions: exterior === "action"
   * Specify the emphasized status of button
   * @type { boolean } [emphasized= false]
   */
  export let emphasized = false;

  /**
   * Preconditions: disabled === true
   * Cursor not-allowed when the button is disabled
   * @type { boolean } [notAllowed= false]
   */
  export let notAllowed = false;

  const eventsListen = getEventsAction(current_component);
  $: buttonProps = {
    id,
    type,
    role: "button",
    tabindex,
    disabled,
    ...$$restProps,
    class: [
      exterior === "general" && "spectrum-Button",
      exterior === "general" && `spectrum-Button--${variant}`,
      exterior === "general" && isQuiet && `spectrum-Button--quiet`,
      exterior === "clear" && "spectrum-ClearButton",
      exterior === "clear" && `spectrum-ClearButton--${variant}`,
      exterior === "clear" && (isSmall ? "spectrum-ClearButton--small" : "spectrum-ClearButton--medium"),
      exterior === "logic-or" && "spectrum-LogicButton spectrum-LogicButton--or",
      exterior === "logic-and" && "spectrum-LogicButton spectrum-LogicButton--and",
      exterior === "action" && "spectrum-ActionButton",
      exterior === "action" && isQuiet && `spectrum-ActionButton--quiet`,
      exterior === "action" && emphasized && "spectrum-ActionButton--emphasized",
      isSelected && "is-selected",
      disabled && notAllowed && "not-allowed",
      `${$$restProps.class}`,
    ]
      .filter(Boolean)
      .join(" "),
  };
</script>

<style global>
  .not-allowed:disabled {
    cursor: not-allowed;
  }
</style>

{#if href}
  <a {...buttonProps} aria-label={ariaLabel} {href} {target} use:eventsListen>
    {#if exterior == 'clear' || exterior == 'logic-or' || exterior == 'logic-and'}
      <slot />
    {:else}
      <slot name="button-icon" />
      <span class="spectrum-{exterior == 'action' ? 'ActionButton' : 'Button'}-label">
        <slot />
      </span>
    {/if}
  </a>
{:else}
  <button {...buttonProps} aria-label={ariaLabel} use:eventsListen>
    {#if exterior == 'clear' || exterior == 'logic-or' || exterior == 'logic-and'}
      <slot />
    {:else}
      <slot name="button-icon" />
      <span class="spectrum-{exterior == 'action' ? 'ActionButton' : 'Button'}-label">
        <slot />
      </span>
    {/if}
  </button>
{/if}
