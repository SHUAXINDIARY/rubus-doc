<script>
  import { onMount } from "svelte";
  import { IconAsterisk } from "@rubus/svelte-spectrum-icons-ui";

  /**
   * Specify the align side mode of fieldlabel
   * @type {"above" | "left" | "right"}[alignSide="above"]
   */
  export let alignSide = "above";

  /**
   * Field label for a required field.
   * @type {boolean}[required=false]
   */
  export let required = false;

  /**
   * Specify the label  of fieldlabel
   * @type { string }[alignSide=false]
   */
  export let label = "Label Text";

  /**
   * Specify the reset for attribute  of fieldlabel
   * @type { string }[forTargetId = ""]
   */
  export let forTargetId = "";

  /**
   * Specify the element width of fieldlabel
   * @type { DimensionValue } [width = ""]
   */
  export let width = "";

  /**
   * Specify the element height of fieldlabel
   * @type { DimensionValue } [height = ""]
   */
  export let height = "";

  let fieldLabelEl;
  let relatedID = "";
  onMount(() => {
    let nextNode = fieldLabelEl.nextElementSibling;
    if (nextNode) {
      let relatedEl = nextNode.querySelectorAll("input");
      if (relatedEl.length && relatedEl[0].id) {
        relatedID = relatedEl[0].id;
      }
    }
  });

  $: styleCssText = [
    (width + "").indexOf("size") !== -1 ? `width:var(--spectrum-global-dimension-${width});` : `width:${width}px;`,
    (height + "").indexOf("size") !== -1 ? `height:var(--spectrum-global-dimension-${height});` : `height:${height}px;`,
  ]
    .filter(Boolean)
    .join(" ");
</script>

<label
  for={forTargetId || relatedID}
  class="spectrum-FieldLabel {alignSide !== 'above' && `spectrum-FieldLabel--${alignSide}`} {$$restProps.class}"
  style={styleCssText}
  bind:this={fieldLabelEl}><slot>{label}</slot>
  {#if required}
    <IconAsterisk className="spectrum-FieldLabel-requiredIcon" />
  {/if}
</label>
