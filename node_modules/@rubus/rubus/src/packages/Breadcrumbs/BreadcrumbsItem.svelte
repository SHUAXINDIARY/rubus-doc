<script>
  import { IconChevronRightSmall, IconFolderBreadcrumb } from "@rubus/svelte-spectrum-icons-ui";

  import { ActionMenu } from "../ActionMenu";
  import { onMount } from "svelte";

  /**
   * Set the `href` to use an anchor link
   * @type {string}[href = ""]
   */
  export let href = "";

  /**
   * Whether the breadcrumbs item is dragged marked
   * @type {boolean}[dragged = false]
   */
  export let dragged = false;

  /**
   *Does the breadcrumbs item contain nesting
   * @type {boolean}[nested = false]
   */
  export let nested = false;

  /**
   * Set to `true` to disable the breadcrumbs item
   * @type {boolean}[disabled=false]
   */
  export let disabled = false;

  onMount(() => {
    getIconScale();
  });
  let iconSize = 16;

  function getIconScale() {
    iconSize = parseInt(
      getComputedStyle(document.documentElement).getPropertyValue("--spectrum-global-dimension-size-200")
    );
  }
</script>

<style>
  .is-disabled {
    pointer-events: none;
  }
</style>

<li class="spectrum-Breadcrumbs-item" class:is-dragged={dragged}>
  {#if href}
    <a class="spectrum-Breadcrumbs-itemLink" class:is-disabled={disabled} role="link" aria-current="page" {href}>
      <slot />
    </a>
  {:else}
    {#if nested}
      <!-- TODO -->
      <ActionMenu isQuiet {disabled}>
        <IconFolderBreadcrumb width={iconSize} height={iconSize} scale={iconSize === 16 ? 'M' : 'L'} />
      </ActionMenu>
    {:else}
      <div
        class="spectrum-Breadcrumbs-itemLink"
        class:is-disabled={disabled}
        aria-disabled={disabled}
        role="link"
        tabindex="0">
        <slot />
      </div>
    {/if}
    <IconChevronRightSmall className="spectrum-Breadcrumbs-itemSeparator" focusable="false" aria-hidden="true" />
  {/if}
</li>
