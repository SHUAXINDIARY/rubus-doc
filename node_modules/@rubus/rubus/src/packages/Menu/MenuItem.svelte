<script>
  import { current_component } from "svelte/internal";
  import { getEventsAction } from "../utils/get-events-action.js";
  import { IconCheckmarkMedium, IconChevronRightMedium } from "@rubus/svelte-spectrum-icons-ui";

  /**
   * Specify the label of  menu item
   * @type {string} [label = ""]
   */
  export let label = "";

  /**
   * Specify the selected status of  menu item
   * @type {boolean} [isSelected = false]
   */
  export let isSelected = false;

  /**
   * Set to `true` to disable the menu item
   * @type {boolean}[disabled=false]
   */
  export let disabled = false;

  /**
   * Specify the divider status of  menu item
   * @type {boolean} [isDivider = false]
   */
  export let isDivider = false;

  /**
   * Specify the finally result index of  menu item
   * @type {number} [resultIndex = 0]
   */
  export let resultIndex = 0;

  /**
   * Specify the this item index of  menu item
   * @type {number} [thisIndex = 0]
   */
  export let thisIndex = 0;

  /**
   * Specify the tabindex of  menu item
   * @type {number} [tabindex = 0]
   */
  export let tabindex = 0;

  /**
   * Specify the role of  menu item
   * @type {string} [role = "menuitem"]
   */
  export let role = "menuitem";

  /**
   * Whether to display Checkmark icon
   * @type {number} [showCheckmark = true]
   */
  export let showCheckmark = true;

  /**
   * Specify the nested mode of  menu item
   * @type {boolean} [nested = false]
   */
  export let nested = false;

  const eventsListen = getEventsAction(current_component);
  function dropdownPick() {
    resultIndex = thisIndex;
  }
</script>

<style global>
  .spectrum-Menu-item {
    width: 100%;
  }
  .spectrum-Menu-itemIcon {
    text-align: center;

    right: 0;
  }
  .spectrum-Menu-item.is-disabled {
    pointer-events: none;
  }
</style>

{#if isDivider}
  <li class="spectrum-Menu-divider" role="separator" />
{:else}
  <li
    class="spectrum-Menu-item"
    class:is-selected={!nested && (isSelected || resultIndex === thisIndex)}
    class:is-disabled={disabled}
    class:is-open={nested && (isSelected || resultIndex === thisIndex)}
    {role}
    {tabindex}
    on:click={!disabled && dropdownPick}
    use:eventsListen>
    <slot><span class="spectrum-Menu-itemLabel">{label}</span></slot>
    {#if nested && (isSelected || resultIndex === thisIndex)}
      <IconChevronRightMedium
        className="spectrum-UIIcon-ChevronRightMedium spectrum-Menu-chevron spectrum-Menu-itemIcon"
        focusable="false"
        width="6"
        height="10"
        aria-hidden={isSelected}
        aria-label="Next" />
    {:else if showCheckmark}
      <IconCheckmarkMedium
        className="spectrum-Menu-checkmark spectrum-Menu-itemIcon"
        focusable="false"
        width="12"
        height="12"
        aria-hidden={isSelected} />
    {/if}
  </li>
{/if}
