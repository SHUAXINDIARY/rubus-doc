<script>
  import Modal from "../Modal";

  /**
   * Specify the title of tray
   * @type {string} [title = ""]
   */
  export let title = "";

  /**
   * Specify the css `z-index` of tray
   * @type {number} [zIndex = 100]
   */
  export let zIndex = 100;

  /**
   * Whether to keep the open status
   * @type {boolean} [isOpen = false]
   */
  export let isOpen = false;

  /**
   * Whether to allow clicking on the Underlay area to close the tray
   * @type {boolean} [puncture = false]
   */
  export let puncture = false;

  /**
   * The element css max-height
   * @type {DimensionValue} [maxHeight = 1149]
   */
  export let maxHeight = 1149;

  function cancelDialog() {
    isOpen = false;
  }

  $: styleCssText = [
    maxHeight && maxHeight.toString().indexOf("size") !== -1
      ? `max-height:calc(var(--spectrum-global-dimension-${maxHeight}) - var(--spectrum-tray-margin-top));`
      : maxHeight.toString().indexOf("%") !== -1
      ? `max-height: calc(${maxHeight} - var(--spectrum-tray-margin-top));`
      : `max-height: calc(${maxHeight}px - var(--spectrum-tray-margin-top));`,
  ]
    .filter(Boolean)
    .join(" ");
</script>

<div class="spectrum-Underlay" class:is-open={isOpen} style="z-index:{zIndex}" on:click={puncture && cancelDialog} />

<Modal class="spectrum-Tray-wrapper" zIndex={+zIndex + 1} innerClass="spectrum-Tray" {isOpen} innerStyle={styleCssText}>
  <section
    class="spectrum-Dialog spectrum-Dialog--large"
    class:is-open={isOpen}
    role="dialog"
    tabindex="-1"
    aria-modal="true"
    style="z-index:{+zIndex + 1}">
    <div class="spectrum-Dialog-grid" class:is-open={isOpen}>
      <h1 class="spectrum-Dialog-heading spectrum-Dialog-heading--noHeader">{title}</h1>
      <hr class="spectrum-Divider spectrum-Divider--medium spectrum-Divider--horizontal spectrum-Dialog-divider" />
      <section class="spectrum-Dialog-content">
        <slot />
      </section>
    </div>
  </section>
</Modal>
