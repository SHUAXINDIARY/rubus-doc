<script>
  import { onMount } from "svelte";
  import { current_component } from "svelte/internal";
  import { getEventsAction } from "../utils/get-events-action.js";

  /**
   * Specify the total step number of step item
   * @type { number } [totalStep = 4]
   */
  export let totalStep = 4;

  /**
   * Specify the  step number of step item
   * @type { number } [thisStep = 1]
   */
  export let thisStep = 1;

  /**
   * Specify the active step number of step item
   * @type { number } [activeStep = 1]
   */
  export let activeStep = 1;

  /**
   * whether the step item is selected
   * @type { boolean } [activeStep = 1]
   */
  export let isSelected = false;

  /**
   * Specify the label text of step item
   * @type { string } [label = "Step"]
   */
  export let label = "Step";
  /**
   * Set to `true` to disable the step item
   * @type {boolean}[disabled=false]
   */
  export let disabled = false;

  /**
   * Whether to use tooltip
   * @type {boolean}[tooltip=false]
   */
  export let tooltip = false;

  let stepItemEl;
  let isComplete = false;
  let interactive = false;
  const eventsListen = getEventsAction(current_component);
  onMount(() => {
    interactive = stepItemEl.parentNode.classList.contains("spectrum-Steplist--interactive");
    //Todo tooltip
    tooltip;
  });

  $: if (activeStep > thisStep) {
    isComplete = true;
  }
</script>

<style global>
  .spectrum-Steplist-item.is-disabled {
    pointer-events: none;
  }
</style>

<div
  class="spectrum-Steplist-item "
  class:is-complete={isComplete}
  class:is-selected={isSelected}
  class:is-disabled={disabled}
  role="listitem"
  aria-posinset={thisStep}
  aria-setsize={totalStep}
  bind:this={stepItemEl}>
  {#if interactive}
    <a
      class="spectrum-Steplist-link"
      class:is-complete={isComplete}
      class:is-selected={isSelected}
      role="link"
      tabindex={isSelected ? 0 : -1}
      aria-current={isSelected && 'step'}
      href="#all"
      use:eventsListen>
      {#if label}
        <span class="spectrum-Steplist-label"><slot>{label + ' ' + thisStep}</slot></span>
      {/if}
      <span class="spectrum-Steplist-markerContainer"> <span class="spectrum-Steplist-marker" /> </span>
    </a>
  {:else}
    {#if label}
      <span class="spectrum-Steplist-label"><slot>{label + ' ' + thisStep}</slot></span>
    {/if}
    <span class="spectrum-Steplist-markerContainer"> <span class="spectrum-Steplist-marker" /> </span>
  {/if}
  <span class="spectrum-Steplist-segment" />
</div>
