<script>
  import { getContext } from "svelte";
  import { IconCrossSmall } from "@rubus/svelte-spectrum-icons-ui";
  import Button from "../Button";
  import Image from "../Asset/Image.svelte";

  /**
   *  Specify the label text for the tag
   * @type {string} [label = "Tag"]
   */
  export let label = "Tag";

  /**
   * Whether to invalid the tag
   * @type {boolean}[isInvalid=false]
   */
  export let isInvalid = false;

  /**
   * Whether to disabled the tag
   * @type {boolean}[disabled=false]
   */
  export let disabled = false;

  /**
   * The element tabindex attribute
   * @type { boolean | number } [tabindex = false]
   */
  export let tabindex = false;

  /**
   *  Specify the avatar img element art attribute for the tag
   * @type {string} [avatarAlt = "Avatar"]
   */
  export let avatarAlt = "Avatar";

  /**
   *  Specify the avatar img element url attribute for the tag
   * @type {string} [avatarUrl = ""]
   */
  export let avatarUrl = "";

  /**
   *  Control the display or hide of this component
   * @type {boolean} [ showTag = true ]
   */
  export let showTag = true;

  /**
   *  Whether to provide editable options
   * @type {boolean} [ editable = getContext("rubusTagsEditable") ]
   */
  export let editable = getContext("rubusTagsEditable");
</script>

<style global>
  .spectrum-Tags-item > .spectrum-ClearButton.focus-ring > .spectrum-Icon {
    fill: var(--spectrum-actionbutton-icon-color-key-focus, var(--spectrum-alias-icon-color-focus));
  }
</style>

{#if showTag}
  <div class="spectrum-Tags-item" class:is-invalid={isInvalid} class:is-disabled={disabled} role="listitem" {tabindex}>
    {#if avatarUrl}
      <Image class="spectrum-Avatar" imgAlt={avatarAlt} imgUrl={avatarUrl} />
    {/if}
    <slot />
    <span class="spectrum-Tags-itemLabel">{label}</span>
    {#if editable}
      <Button exterior="clear" isSmall on:click on:keydown on:keyup on:mousedown on:mouseup {tabindex}>
        <IconCrossSmall />
      </Button>
    {/if}
  </div>
{/if}
