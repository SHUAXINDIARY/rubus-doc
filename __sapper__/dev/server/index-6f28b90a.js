'use strict';

/**
 *  Copyright 2018 Adobe. All rights reserved.
 *  This file is licensed to you under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License. You may obtain a copy
 *  of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software distributed under
 *  the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 *  OF ANY KIND, either express or implied. See the License for the specific language
 *  governing permissions and limitations under the License.
 */

// Provides explicit indication of elements receiving focus through keyboard interaction rather than mouse or touch.
(function (doc) {
  // In case file is imported in SSR context, don't polyfill anything
  if (!doc) {
    return;
  }

  var NAVIGATION_KEYS = [
    "Tab",
    "ArrowUp",
    "ArrowRight",
    "ArrowDown",
    "ArrowLeft",
    "Home",
    "End",
    "PageUp",
    "PageDown",
    "Enter",
    " ",
    "Escape",

    /* IE9 and Firefox < 37 */
    "Up",
    "Right",
    "Down",
    "Left",
    "Esc",
  ];
  var TEXT_INPUT_TYPES = [
    "text",
    "date",
    "datetime-local",
    "email",
    "month",
    "number",
    "password",
    "search",
    "tel",
    "time",
    "url",
    "week",
  ];
  var keyboardFocus = false;
  var elements = doc.getElementsByClassName("focus-ring");

  function onKeydownHandler(event) {
    if (event.ctrlKey || event.altKey || event.metaKey || NAVIGATION_KEYS.indexOf(event.key) === -1) {
      return;
    }
    keyboardFocus = true;

    if (
      doc.activeElement &&
      doc.activeElement !== doc.body &&
      doc.activeElement.tagName !== "TEXTAREA" &&
      !(doc.activeElement.tagName === "INPUT" && TEXT_INPUT_TYPES.indexOf(doc.activeElement.type) !== -1)
    ) {
      doc.activeElement.classList.add("focus-ring");
    }
  }

  function onMousedownHandler() {
    keyboardFocus = false;

    for (var i = 0; i < elements.length; i++) {
      elements[i].classList.remove("focus-ring");
    }
  }

  function onFocusHandler(event) {
    var classList = event.target.classList;
    if (classList && keyboardFocus) {
      classList.add("focus-ring");
    }
  }

  function onBlurHandler(event) {
    var classList = event.target.classList;
    classList && classList.remove("focus-ring");
  }

  doc.addEventListener("keydown", onKeydownHandler, true);
  doc.addEventListener("mousedown", onMousedownHandler, true);
  doc.addEventListener("focus", onFocusHandler, true);
  doc.addEventListener("blur", onBlurHandler, true);
})(typeof window === "undefined" ? undefined : document);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgtNmYyOGI5MGEuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9AcnVidXMvcnVidXMvc3JjL3BhY2thZ2VzL3V0aWxzL2ZvY3VzLXJpbmctcG9seWZpbGwvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiAgQ29weXJpZ2h0IDIwMTggQWRvYmUuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgVGhpcyBmaWxlIGlzIGxpY2Vuc2VkIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5XG4gKiAgb2YgdGhlIExpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXJcbiAqICB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBSRVBSRVNFTlRBVElPTlNcbiAqICBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2VcbiAqICBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8vIFByb3ZpZGVzIGV4cGxpY2l0IGluZGljYXRpb24gb2YgZWxlbWVudHMgcmVjZWl2aW5nIGZvY3VzIHRocm91Z2gga2V5Ym9hcmQgaW50ZXJhY3Rpb24gcmF0aGVyIHRoYW4gbW91c2Ugb3IgdG91Y2guXG4oZnVuY3Rpb24gKGRvYykge1xuICAvLyBJbiBjYXNlIGZpbGUgaXMgaW1wb3J0ZWQgaW4gU1NSIGNvbnRleHQsIGRvbid0IHBvbHlmaWxsIGFueXRoaW5nXG4gIGlmICghZG9jKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIE5BVklHQVRJT05fS0VZUyA9IFtcbiAgICBcIlRhYlwiLFxuICAgIFwiQXJyb3dVcFwiLFxuICAgIFwiQXJyb3dSaWdodFwiLFxuICAgIFwiQXJyb3dEb3duXCIsXG4gICAgXCJBcnJvd0xlZnRcIixcbiAgICBcIkhvbWVcIixcbiAgICBcIkVuZFwiLFxuICAgIFwiUGFnZVVwXCIsXG4gICAgXCJQYWdlRG93blwiLFxuICAgIFwiRW50ZXJcIixcbiAgICBcIiBcIixcbiAgICBcIkVzY2FwZVwiLFxuXG4gICAgLyogSUU5IGFuZCBGaXJlZm94IDwgMzcgKi9cbiAgICBcIlVwXCIsXG4gICAgXCJSaWdodFwiLFxuICAgIFwiRG93blwiLFxuICAgIFwiTGVmdFwiLFxuICAgIFwiRXNjXCIsXG4gIF07XG4gIHZhciBURVhUX0lOUFVUX1RZUEVTID0gW1xuICAgIFwidGV4dFwiLFxuICAgIFwiZGF0ZVwiLFxuICAgIFwiZGF0ZXRpbWUtbG9jYWxcIixcbiAgICBcImVtYWlsXCIsXG4gICAgXCJtb250aFwiLFxuICAgIFwibnVtYmVyXCIsXG4gICAgXCJwYXNzd29yZFwiLFxuICAgIFwic2VhcmNoXCIsXG4gICAgXCJ0ZWxcIixcbiAgICBcInRpbWVcIixcbiAgICBcInVybFwiLFxuICAgIFwid2Vla1wiLFxuICBdO1xuICB2YXIga2V5Ym9hcmRGb2N1cyA9IGZhbHNlO1xuICB2YXIgZWxlbWVudHMgPSBkb2MuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImZvY3VzLXJpbmdcIik7XG5cbiAgZnVuY3Rpb24gb25LZXlkb3duSGFuZGxlcihldmVudCkge1xuICAgIGlmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50LmFsdEtleSB8fCBldmVudC5tZXRhS2V5IHx8IE5BVklHQVRJT05fS0VZUy5pbmRleE9mKGV2ZW50LmtleSkgPT09IC0xKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGtleWJvYXJkRm9jdXMgPSB0cnVlO1xuXG4gICAgaWYgKFxuICAgICAgZG9jLmFjdGl2ZUVsZW1lbnQgJiZcbiAgICAgIGRvYy5hY3RpdmVFbGVtZW50ICE9PSBkb2MuYm9keSAmJlxuICAgICAgZG9jLmFjdGl2ZUVsZW1lbnQudGFnTmFtZSAhPT0gXCJURVhUQVJFQVwiICYmXG4gICAgICAhKGRvYy5hY3RpdmVFbGVtZW50LnRhZ05hbWUgPT09IFwiSU5QVVRcIiAmJiBURVhUX0lOUFVUX1RZUEVTLmluZGV4T2YoZG9jLmFjdGl2ZUVsZW1lbnQudHlwZSkgIT09IC0xKVxuICAgICkge1xuICAgICAgZG9jLmFjdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImZvY3VzLXJpbmdcIik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25Nb3VzZWRvd25IYW5kbGVyKCkge1xuICAgIGtleWJvYXJkRm9jdXMgPSBmYWxzZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGVsZW1lbnRzW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJmb2N1cy1yaW5nXCIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uRm9jdXNIYW5kbGVyKGV2ZW50KSB7XG4gICAgdmFyIGNsYXNzTGlzdCA9IGV2ZW50LnRhcmdldC5jbGFzc0xpc3Q7XG4gICAgaWYgKGNsYXNzTGlzdCAmJiBrZXlib2FyZEZvY3VzKSB7XG4gICAgICBjbGFzc0xpc3QuYWRkKFwiZm9jdXMtcmluZ1wiKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvbkJsdXJIYW5kbGVyKGV2ZW50KSB7XG4gICAgdmFyIGNsYXNzTGlzdCA9IGV2ZW50LnRhcmdldC5jbGFzc0xpc3Q7XG4gICAgY2xhc3NMaXN0ICYmIGNsYXNzTGlzdC5yZW1vdmUoXCJmb2N1cy1yaW5nXCIpO1xuICB9XG5cbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIG9uS2V5ZG93bkhhbmRsZXIsIHRydWUpO1xuICBkb2MuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBvbk1vdXNlZG93bkhhbmRsZXIsIHRydWUpO1xuICBkb2MuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIG9uRm9jdXNIYW5kbGVyLCB0cnVlKTtcbiAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIG9uQmx1ckhhbmRsZXIsIHRydWUpO1xufSkodHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IHVuZGVmaW5lZCA6IGRvY3VtZW50KTtcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxVQUFVLEdBQUcsRUFBRTtBQUNoQjtBQUNBLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtBQUNaLElBQUksT0FBTztBQUNYLEdBQUc7QUFDSDtBQUNBLEVBQUUsSUFBSSxlQUFlLEdBQUc7QUFDeEIsSUFBSSxLQUFLO0FBQ1QsSUFBSSxTQUFTO0FBQ2IsSUFBSSxZQUFZO0FBQ2hCLElBQUksV0FBVztBQUNmLElBQUksV0FBVztBQUNmLElBQUksTUFBTTtBQUNWLElBQUksS0FBSztBQUNULElBQUksUUFBUTtBQUNaLElBQUksVUFBVTtBQUNkLElBQUksT0FBTztBQUNYLElBQUksR0FBRztBQUNQLElBQUksUUFBUTtBQUNaO0FBQ0E7QUFDQSxJQUFJLElBQUk7QUFDUixJQUFJLE9BQU87QUFDWCxJQUFJLE1BQU07QUFDVixJQUFJLE1BQU07QUFDVixJQUFJLEtBQUs7QUFDVCxHQUFHLENBQUM7QUFDSixFQUFFLElBQUksZ0JBQWdCLEdBQUc7QUFDekIsSUFBSSxNQUFNO0FBQ1YsSUFBSSxNQUFNO0FBQ1YsSUFBSSxnQkFBZ0I7QUFDcEIsSUFBSSxP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
